
<!DOCTYPE HTML>
<html lang="id" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>10. Socket Client Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../08/08-socket-server.html" />
    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Ketik untuk mencari" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Pendahuluan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../00/kontrak.html">
            
                <a href="../00/kontrak.html">
            
                    
                    Kontrak Kuliah
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    01. Memahami Konsep dan arsitektur IoT
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    02. Microcontroller
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../01/01.installasi-dan-konfigurasi.html">
            
                <a href="../01/01.installasi-dan-konfigurasi.html">
            
                    
                    03. Instalasi, Konfigurasi software & Hardware pendukung
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../02/02-led.html">
            
                <a href="../02/02-led.html">
            
                    
                    04. Implementation NodeMCU LED
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../03/05-Sensor-suhu-dan-kelembaban.html">
            
                <a href="../03/05-Sensor-suhu-dan-kelembaban.html">
            
                    
                    05. Implementasi sensor suhu dan kelembaban
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../04/06-sensor-cahaya.html">
            
                <a href="../04/06-sensor-cahaya.html">
            
                    
                    06. Sensor Cahaya
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../05/06-rfid.html">
            
                <a href="../05/06-rfid.html">
            
                    
                    07. RFID
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../06/07-ultrasonic.html">
            
                <a href="../06/07-ultrasonic.html">
            
                    
                    08. Sensor Ultrasonic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" >
            
                <span>
            
                    
                    09. UTS
            
                </span>
            

            
        </li>
    
        <li class="chapter active" data-level="1.12" data-path="07-socket-client.html">
            
                <a href="07-socket-client.html">
            
                    
                    10. Socket Client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../08/08-socket-server.html">
            
                <a href="../08/08-socket-server.html">
            
                    
                    11. Socket Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../09/09-local-server.html">
            
                <a href="../09/09-local-server.html">
            
                    
                    12. Local Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../10/10-monitoring-controlling-local-server.html">
            
                <a href="../10/10-monitoring-controlling-local-server.html">
            
                    
                    13. Monitoring dan Controlling pada Local Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16" >
            
                <span>
            
                    
                    Nilai
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="../nilai/01-ti-3b.html">
            
                <a href="../nilai/01-ti-3b.html">
            
                    
                    TI-3B
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2" data-path="../nilai/02-ti-3c.html">
            
                <a href="../nilai/02-ti-3c.html">
            
                    
                    TI-3C
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Dipublikasikan dengan GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >10. Socket Client</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="membuat-program-socket-client">Membuat program socket client</h1>
<h2 id="tujuan">Tujuan</h2>
<ul>
<li>Mampu memahami protokol komunikasi socket client TCP/IP</li>
<li>Mampu membuat program komunikasi antara MCU sebagai client socket dan komputer sebagai server socket dengan C#</li>
<li>Mampu membuat program untuk mengirim data sensor dari MCU ke komputer secara real-time dengan protokol komunikasi socket TCP/IP</li>
</ul>
<h2 id="capaian">Capaian</h2>
<ul>
<li>Menjelaskan konsep komunikasi TCP/IP</li>
<li>Menjelaskan konsep protokol Socket TCP/IP agar MCU dapat berkomunikasi dengan perangkat lainnya</li>
<li>Membuat program socket client di sisi MCU yang bertugas mengirim data sensor ke Socket Server C# Desktop GUI secara real-time</li>
</ul>
<h2 id="teori-singkat">Teori Singkat</h2>
<p>Program socket biasanya digunakan untuk komunikasi antara berbagai proses yang berjalan pada sistem yang berbeda, program tersebut kebanyakan dibuat untuk lingkungan program client dan server.</p>
<p>Ada 2 jenis protokol yang dapat digunakan untuk melakukan komunikasi menggunakan socket:</p>
<ol>
<li><p>TCP/IP Socket</p>
<p> Konsep yang digunakan pada protokol ini adalah <em>connection oriented</em> dan <em>reliable data transfer</em>, ketika program yang kita buat menggunakan protokol ini tidak mementingkan kecepatan tetapi lebih mementingkan ketepatan data yang dikirimkan.</p>
<p> <em>Connection oriented</em> sendiri adalah sebuah konsep dimana socket yang terhubung harus memiliki tanggung jawab untuk memberikan notifikasi ketika sedang melakukan pengiriman data, atau sering disebut juga dengan istilah <em>synchronous</em>.</p>
</li>
<li><p>UDP Socket</p>
<p> Berbeda dengan komunikasi protokol TCP/IP, UDP Socket menggunakan konsep <em>connectionless oriented</em> dan <em>unreliable data transfer</em>. Akan cocok sekali ketika kita akan membangun sebuah aplikasi yang lebih mementingkan dengan kecepatan data dengan mengesampingkan ketepatan datanya. UDP Socket menggunakan istilah <em>asynchronous</em>, yang artinya tidak memperdulikan response dari penerima.</p>
</li>
</ol>
<p>Pada kesempatan ini yang akan digunakan adalah protokol TCP/IP, untuk alur dari protokol TCP/IP dapat dilihat pada gambar di bawah ini</p>
<p><img src="images/socket-programming.png" alt=""></p>
<p align="center">https://www.javatpoint.com/socket-programming</p>

<p>Dari gambar di atas terlihat bahwa ketika sebuah server harus melakukan listening yang artinya siap menerima koneksi dari sebuah socket client. Setelah socket server menerima koneksi dari socket client, socket server akan menerima dan selanjutnya bisa dilanjutkan untuk berkomunikasi dengan socket client atau memutuskan komunikasi dengan socket client tersebut.</p>
<p>Buatlah sebuah kode berikut ini, kode tersebut ditulis menggunakan Python.</p>
<h2 id="praktikum">Praktikum</h2>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> socket
<span class="hljs-keyword">from</span> threading <span class="hljs-keyword">import</span> Thread


<span class="hljs-comment"># Multithreaded Python server</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ClientThread</span><span class="hljs-params">(Thread)</span>:</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, ip, port)</span>:</span>
        Thread.__init__(self)
        self.ip = ip
        self.port = port
        print(<span class="hljs-string">&quot;Incoming connection from &quot;</span> + ip + <span class="hljs-string">&quot;:&quot;</span> + str(port))

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
            <span class="hljs-keyword">try</span>:
                data = conn.recv(<span class="hljs-number">2048</span>)
                <span class="hljs-keyword">if</span> len(data) == <span class="hljs-number">0</span>:
                    <span class="hljs-keyword">break</span>

                print(<span class="hljs-string">&quot;length: &quot;</span> + str(len(data)))
                print(<span class="hljs-string">&quot;Server received data:&quot;</span>, data)
                <span class="hljs-comment"># MESSAGE = input(&quot;Input response:&quot;)</span>
                MESSAGE = <span class="hljs-string">&quot;OK&quot;</span>
                conn.send(MESSAGE.encode(<span class="hljs-string">&quot;utf8&quot;</span>))  <span class="hljs-comment"># echo</span>
            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
                print(e)
                <span class="hljs-keyword">break</span>


TCP_IP = <span class="hljs-string">&quot;192.168.43.85&quot;</span>
TCP_PORT = <span class="hljs-number">2004</span>
BUFFER_SIZE = <span class="hljs-number">20</span>

tcpServer = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
tcpServer.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="hljs-number">1</span>)
tcpServer.bind((TCP_IP, TCP_PORT))
threads = []

<span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
    tcpServer.listen(<span class="hljs-number">4</span>)
    print(<span class="hljs-string">&quot;Server started on &quot;</span> + TCP_IP + <span class="hljs-string">&quot; port &quot;</span> + str(TCP_PORT))
    (conn, (ip, port)) = tcpServer.accept()
    newthread = ClientThread(ip, port)
    newthread.start()
    threads.append(newthread)

<span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:
    t.join()
</code></pre>
<p>Setelah program tersebut dijalankan, socket server siap menerima komunikasi dari socket client. Untuk mencobanya bisa menggunakan perintah telnet, caranya adalah sebagai berikut</p>
<pre><code>telnet [host] [port]
</code></pre><p>Setelah berhasil masuk silakan ketikan sesuatu dan tekan enter.</p>
<blockquote>
<p>Silakan disesuaikan kode di atas untuk host dan port yang digunakan, ganti kode <code>TCP_IP = &quot;192.168.43.85&quot;</code> dan <code>TCP_PORT = 2004</code></p>
</blockquote>
<p>Setelah berhasil menjalankan socket sever, selanjutnya perlu dibuat socket client yang berjalan di controller atau ESP8266 Amica atau Lolita yang Anda miliki. Buatlah kode berikut</p>
<pre><code class="lang-cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Arduino.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;ESP8266WiFi.h&gt;</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED D4</span>

<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *ssid = <span class="hljs-string">&quot;***&quot;</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *password = <span class="hljs-string">&quot;***&quot;</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint16_t</span> port = <span class="hljs-number">2004</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *host = <span class="hljs-string">&quot;192.168.43.85&quot;</span>;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">connect_wifi</span><span class="hljs-params">()</span>
</span>{
  Serial.<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Connecting to %s &quot;</span>, ssid);
  WiFi.begin(ssid, password);
  <span class="hljs-keyword">while</span> (WiFi.status() != WL_CONNECTED)
  {
    delay(<span class="hljs-number">500</span>);
    Serial.print(<span class="hljs-string">&quot;.&quot;</span>);
  }
  Serial.println(<span class="hljs-string">&quot; connected&quot;</span>);
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">connect_server</span><span class="hljs-params">()</span>
</span>{
  WiFiClient client;

  Serial.<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n[Connecting to %s ... &quot;</span>, host);
  <span class="hljs-keyword">if</span> (client.connect(host, port))
  {
    Serial.println(<span class="hljs-string">&quot;connected]&quot;</span>);

    Serial.println(<span class="hljs-string">&quot;[Sending a request]&quot;</span>);
    client.print(<span class="hljs-string">&quot;Hai from ESP8266&quot;</span>);

    Serial.println(<span class="hljs-string">&quot;[Response:]&quot;</span>);
    String line = client.readStringUntil(<span class="hljs-string">&apos;\n&apos;</span>);
    Serial.println(line);
    client.stop();
    Serial.println(<span class="hljs-string">&quot;\n[Disconnected]&quot;</span>);
  }
  <span class="hljs-keyword">else</span>
  {
    Serial.println(<span class="hljs-string">&quot;connection failed!]&quot;</span>);
    client.stop();
  }
  delay(<span class="hljs-number">3000</span>);
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span>
</span>{
  Serial.begin(<span class="hljs-number">115200</span>);
  connect_wifi();
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span>
</span>{
  connect_server();
}
</code></pre>
<p>Untuk dapat berkomunikasi dengan socket server, ESP8266 sudah terdapat modul wifi yang siap untuk digunakan. Ubahlah kode di bawah ini sesuai dengan kebutuhan Anda.</p>
<pre><code class="lang-cpp"><span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *ssid = <span class="hljs-string">&quot;***&quot;</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *password = <span class="hljs-string">&quot;***&quot;</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint16_t</span> port = <span class="hljs-number">2004</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *host = <span class="hljs-string">&quot;192.168.43.85&quot;</span>;
</code></pre>
<p>Keterangan:</p>
<ul>
<li><code>ssid</code> adalah ssid yang bisa digunakan untuk berkomunikasi, bisa tethering dengan handphone.</li>
<li><code>password</code> adalah password ssid yang digunakan.</li>
<li><code>port</code> adalah port socket sever aplikasi yang telah kita buat sebelumnya.</li>
<li><code>host</code> adalah host tempat socket server dijalankan, jika di local bisa menggunakan <code>localhost atau 127.0.0.1.</code></li>
</ul>
<p>Silakan upload program tersebut ke controller Anda dan amati outputnya pada serial monitor.</p>
<h2 id="tugas">Tugas</h2>
<p>Dianalogikan Anda mempunyai sebuah smart home dimana terpasang pada smart home tersebut sensor DHT11, sensor suhu, sensor cahaya, dan pada sebuah pintu juga terpasang teknologi RFID.</p>
<p>Kirimkan semua data sensor tersebut secara berkala ke server, selanjutnya dalam sebuah kondisi Anda juga dapat mengirimkan UID kartu pada pintu ke server ketika pintu dibuka menggunakan smart card.</p>
<p>Jangan lupa sebelum membuat program tersebut, buatlah terlebih dahulu skematik dari semua sensor dan controller yang digunakan menggunakan fritzing.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> hasil yang cocok "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">Tidak ada hasil yang cocok "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
                <a href="../08/08-socket-server.html" class="navigation navigation-next navigation-unique" aria-label="Next page: 11. Socket Server">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"10. Socket Client","level":"1.12","depth":1,"next":{"title":"11. Socket Server","level":"1.13","depth":1,"path":"08/08-socket-server.md","ref":"08/08-socket-server.md","articles":[]},"previous":{"title":"09. UTS","level":"1.11","depth":1,"ref":"","articles":[]},"dir":"ltr"},"config":{"plugins":[],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"id","gitbook":"*"},"file":{"path":"07/07-socket-client.md","mtime":"2020-06-28T16:08:15.088Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-06-28T16:08:58.372Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

